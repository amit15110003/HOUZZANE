!function($,window,document,undefined){function WCPEditor(){this.host=$("#wcp-editor"),this.forms={},this.tooltip=undefined,this.modal=undefined,this.modalTimeout=undefined,this.loadingScreen=undefined,this.loadingScreenTimeout=undefined,this.saveToDeleteID=undefined}function WCPEditorForm(options){this.options=options,this.id="wcp-form-"+(Math.floor(9999*Math.random())+1),this.controls=[],this.formUpdated=undefined,this.model={},this.selectedTab=0}function WCPEditorControl(controlOptions,controlRegisteredSettings,valueUpdated){this.id=Math.floor(9999*Math.random())+1,this.elementID="wcp-editor-control-"+this.id,this.elementClass="sq-element-option-group",this.type=controlRegisteredSettings.type,this.getValue=controlRegisteredSettings.getValue,this.setValue=controlRegisteredSettings.setValue,this.HTML=controlRegisteredSettings.HTML,this.name=controlOptions.name,this.title=controlOptions.title,this.options=controlOptions.options,this._value=undefined,this.init=controlRegisteredSettings.init,this.init(),this.valueUpdated=valueUpdated,this.customLabel=controlRegisteredSettings.customLabel}function clearSelection(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}var wcpEditor=undefined,wcpForms=[],registeredControls=[];WCPEditor.prototype.init=function(options){this.options=options;var html="",canvasClass="";this.options.canvasFill&&(canvasClass="wcp-editor-canvas-fill");var canvasStyle="";this.options.canvasFill||(canvasStyle+="width: "+this.options.canvasWidth+"px; height: "+this.options.canvasHeight+"px;"),html+='<div id="wcp-editor-left">',html+='   <div id="wcp-editor-main-buttons">',this.options.newButton&&(html+='       <div id="wcp-editor-button-new" class="wcp-editor-main-button">',html+='           <div class="wcp-editor-main-button-icon"><i class="fa fa-file" aria-hidden="true"></i></div>',html+='           <div class="wcp-editor-main-button-text">New</div>',html+="       </div>"),html+='       <div id="wcp-editor-button-save" class="wcp-editor-main-button">',html+='           <div class="wcp-editor-main-button-icon"><i class="fa fa-floppy-o" aria-hidden="true"></i></div>',html+='           <div class="wcp-editor-main-button-text">Save</div>',html+="       </div>",html+='       <div id="wcp-editor-button-load" class="wcp-editor-main-button">',html+='           <div class="wcp-editor-main-button-icon"><i class="fa fa-sign-out" aria-hidden="true"></i></div>',html+='           <div class="wcp-editor-main-button-text">Load</div>',html+="       </div>",html+='       <div id="wcp-editor-button-undo" class="wcp-editor-main-button">',html+='           <div class="wcp-editor-main-button-icon"><i class="fa fa-undo" aria-hidden="true"></i></div>',html+='           <div class="wcp-editor-main-button-text">Undo</div>',html+="       </div>",html+='       <div id="wcp-editor-button-redo" class="wcp-editor-main-button">',html+='           <div class="wcp-editor-main-button-icon"><i class="fa fa-repeat" aria-hidden="true"></i></div>',html+='           <div class="wcp-editor-main-button-text">Redo</div>',html+="       </div>",html+='       <div id="wcp-editor-button-preview" class="wcp-editor-main-button">',html+='           <div class="wcp-editor-main-button-icon"><i class="fa fa-eye" aria-hidden="true"></i></div>',html+='           <div class="wcp-editor-main-button-text">Preview</div>',html+="       </div>",html+="   </div>",html+='<div id="wcp-editor-main-tab-buttons">';for(var i=0;i<this.options.mainTabs.length;i++)html+='<div class="wcp-editor-main-tab-button" data-wcp-main-tab-button-name="'+this.options.mainTabs[i].name+'">',html+='   <div class="wcp-editor-main-tab-button-icon"><i class="'+this.options.mainTabs[i].icon+'" aria-hidden="true"></i></div>',html+='   <div class="wcp-editor-main-tab-button-text">'+this.options.mainTabs[i].name+"</div>",html+="</div>";html+="</div>",html+='<div id="wcp-editor-main-tab-contents">';for(var i=0;i<this.options.mainTabs.length;i++)html+='<div class="wcp-editor-main-tab-content" data-wcp-main-tab-content-name="'+this.options.mainTabs[i].name+'">',html+='   <div class="wcp-editor-main-tab-content-title">'+this.options.mainTabs[i].title+"</div>",html+='   <div class="wcp-editor-main-tab-content-inner-wrap">'+$.wcpEditorGetContentForTabWithName(this.options.mainTabs[i].name)+"</div>",html+="</div>";html+="</div>",html+="</div>",html+='<div id="wcp-editor-center">',this.options.newButton&&(html+='<div id="wcp-editor-help-button"><i class="fa fa-question" aria-hidden="true"></i></div>'),html+='    <div id="wcp-editor-extra-main-buttons">';for(var i=0;i<this.options.extraMainButtons.length;i++){var b=this.options.extraMainButtons[i];html+='       <div class="wcp-editor-extra-main-button" data-wcp-editor-extra-main-button-name="'+b.name+'">',html+='           <div class="wcp-editor-extra-main-button-icon"><i class="'+b.icon+'" aria-hidden="true"></i></div>',html+='           <div class="wcp-editor-extra-main-button-title">'+b.title+"</div>",html+="       </div>"}html+="    </div>",html+='    <div id="wcp-editor-toolbar">';for(var i=0;i<this.options.toolbarButtons.length;i++){var b=this.options.toolbarButtons[i],icon="";icon=b.customIcon!=undefined?b.customIcon:'<i class="'+b.icon+'" aria-hidden="true"></i>',html+='       <div class="wcp-editor-toolbar-button" data-wcp-editor-toolbar-button-name="'+b.name+'" data-wcp-tooltip="'+b.title+'" data-wcp-tooltip-position="right">',html+='           <div class="wcp-editor-toolbar-button-icon">'+icon+"</div>",html+='           <div class="wcp-editor-toolbar-button-title">'+b.title+"</div>",html+="       </div>"}html+="    </div>",html+='    <div id="wcp-editor-canvas" class="'+canvasClass+'" style="'+canvasStyle+'">'+$.wcpEditorGetContentForCanvas()+"</div>",html+="</div>",html+='<div id="wcp-editor-right">',html+="</div>",this.host.html(html),this.setListItems($.wcpEditorGetListItems()),this.openMainTabWithName(this.options.mainTabs[0].name),this.events()},WCPEditor.prototype.events=function(){var self=this;$("[data-wcp-main-tab-button-name]").on("click",function(){var name=$(this).data("wcp-main-tab-button-name");self.openMainTabWithName(name)}),$(document).off("click","#wcp-editor-button-new"),$(document).on("click","#wcp-editor-button-new",function(){$.wcpEditorEventNewButtonPressed(),self.presentCreateNewModal()}),$(document).off("click","#wcp-editor-button-save"),$(document).on("click","#wcp-editor-button-save",function(){$.wcpEditorEventSaveButtonPressed()}),$(document).off("click","#wcp-editor-button-load"),$(document).on("click","#wcp-editor-button-load",function(){$.wcpEditorEventLoadButtonPressed(),self.presentLoadModal()}),$(document).off("click","#wcp-editor-button-undo"),$(document).on("click","#wcp-editor-button-undo",function(){$.wcpEditorEventUndoButtonPressed()}),$(document).off("click","#wcp-editor-button-redo"),$(document).on("click","#wcp-editor-button-redo",function(){$.wcpEditorEventRedoButtonPressed()}),$(document).off("click","#wcp-editor-button-preview"),$(document).on("click","#wcp-editor-button-preview",function(){$.wcpEditorEventPreviewButtonPressed(),self.options.previewToggle&&($(this).hasClass("wcp-active")?($(this).removeClass("wcp-active"),$.wcpEditorEventExitedPreviewMode()):($(this).addClass("wcp-active"),$.wcpEditorEventEnteredPreviewMode()))}),$(document).off("click",".wcp-editor-extra-main-button"),$(document).on("click",".wcp-editor-extra-main-button",function(e){var buttonName=$(this).data("wcp-editor-extra-main-button-name");$.wcpEditorEventExtraMainButtonClick(buttonName),"import"==buttonName&&self.presentImportModal(),"export"==buttonName&&self.presentExportModal()}),$(document).off("click",".wcp-editor-toolbar-button"),$(document).on("click",".wcp-editor-toolbar-button",function(e){$(".wcp-editor-toolbar-button").removeClass("wcp-active"),$(this).addClass("wcp-active"),$.wcpEditorEventSelectedTool($(this).data("wcp-editor-toolbar-button-name"))}),$(document).off("click","#wcp-editor-help-button"),$(document).on("click","#wcp-editor-help-button",function(e){$.wcpEditorEventHelpButtonPressed()}),$(document).off("mouseover",".wcp-editor-list-item"),$(document).on("mouseover",".wcp-editor-list-item",function(e){$.wcpEditorEventListItemMouseover($(this).data("wcp-editor-list-item-id"))}),$(document).off("click",".wcp-editor-list-item"),$(document).on("click",".wcp-editor-list-item",function(e){0==$(e.target).closest(".wcp-editor-list-item-buttons").length&&(self.selectListItem($(this).data("wcp-editor-list-item-id")),$.wcpEditorEventListItemSelected($(this).data("wcp-editor-list-item-id")))}),$(document).off("click",".wcp-editor-list-item-button"),$(document).on("click",".wcp-editor-list-item-button",function(){var itemID=$(this).closest(".wcp-editor-list-item").data("wcp-editor-list-item-id"),buttonName=$(this).data("wcp-editor-list-item-button-name");$.wcpEditorEventListItemButtonPressed(itemID,buttonName)}),$(document).off("mouseover","[data-wcp-tooltip]"),$(document).on("mouseover","[data-wcp-tooltip]",function(e){self.showTooltip($(this),$(this).data("wcp-tooltip"),$(this).data("wcp-tooltip-position"))}),$(document).off("mouseout","[data-wcp-tooltip]"),$(document).on("mouseout","[data-wcp-tooltip]",function(e){self.hideTooltip($(this))}),$(document).off("click","#wcp-editor-modal"),$(document).on("click","#wcp-editor-modal",function(e){if("wcp-editor-modal"==$(e.target).attr("id")){self.closeModal();var modalName=$("#wcp-editor-modal").data("wcp-editor-modal-name");$.wcpEditorEventModalClosed(modalName)}}),$(document).off("click",".wcp-editor-modal-close"),$(document).on("click",".wcp-editor-modal-close",function(e){self.closeModal();var modalName=$("#wcp-editor-modal").data("wcp-editor-modal-name");$.wcpEditorEventModalClosed(modalName)}),$(document).off("click",".wcp-editor-modal-button"),$(document).on("click",".wcp-editor-modal-button",function(e){var modalName=$("#wcp-editor-modal").data("wcp-editor-modal-name"),buttonName=$(this).data("wcp-editor-modal-button-name");$.wcpEditorEventModalButtonClicked(modalName,buttonName)}),$(document).off("click","#wcp-editor-confirm-import"),$(document).on("click","#wcp-editor-confirm-import",function(e){var json=$("#wcp-editor-textarea-import").val(),parsedJSON=undefined;try{parsedJSON=JSON.parse(json)}catch(err){console.log("error decoding JSON!")}parsedJSON===undefined?$("#wcp-editor-import-error").show():($("#wcp-editor-import-error").hide(),$.wcpEditorEventImportedJSON(parsedJSON),self.closeModal())}),$(document).off("click","#wcp-editor-button-create-new-instance"),$(document).on("click","#wcp-editor-button-create-new-instance",function(e){if(0==$("#wcp-editor-input-create-new").val().length)$("#wcp-editor-create-new-error").show();else{$("#wcp-editor-create-new-error").hide();var instanceName=$("#wcp-editor-input-create-new").val();$.wcpEditorEventCreatedNewInstance(instanceName),self.closeModal()}}),$(document).off("click",".wcp-editor-save-list-item"),$(document).on("click",".wcp-editor-save-list-item",function(){var saveID=$(this).parent().data("wcp-editor-save-list-item-id");$.wcpEditorEventLoadSaveWithID(saveID),self.closeModal()}),$(document).off("click",".wcp-editor-save-list-item-delete-button"),$(document).on("click",".wcp-editor-save-list-item-delete-button",function(){self.saveToDeleteID=$(this).parent().data("wcp-editor-save-list-item-id"),self.closeModal(),self.presentDeleteSaveConfirmationModal()}),$(document).off("click","#wcp-editor-cancel-delete-save"),$(document).on("click","#wcp-editor-cancel-delete-save",function(){self.presentLoadModal()}),$(document).off("click","#wcp-editor-confirm-delete-save"),$(document).on("click","#wcp-editor-confirm-delete-save",function(){$.wcpEditorEventDeleteSaveWithID(self.saveToDeleteID,function(){self.presentLoadModal()})}),$(document).off("keyup","#wcp-editor-input-create-new"),$(document).on("keyup","#wcp-editor-input-create-new",function(e){13==e.keyCode&&$("#wcp-editor-modal").length>0&&$("#wcp-editor-modal").hasClass("wcp-editor-modal-visible")&&(1==$(".wcp-editor-modal-button-primary").length&&$(".wcp-editor-modal-button-primary").click(),1==$(".wcp-editor-modal-button-danger").length&&$(".wcp-editor-modal-button-danger").click())});var iex=0,iey=0,ix=0,iy=0,shouldStartDragging=!1,didStartDragging=!1,dragThreshold=5,dragMap=[],startingItemIndex=-1,currentItemIndex=-1,draggedListItem=undefined,listItemCopy=undefined,draggedListItemWidth=0,draggedListItemHeight=0,listScroll=0;$(document).off("mousedown",".wcp-editor-list-item"),$(document).on("mousedown",".wcp-editor-list-item",function(e){iex=e.pageX,iey=e.pageY,shouldStartDragging=!0,draggedListItem=$(this),startingItemIndex=draggedListItem.data("wcp-editor-list-item-index"),draggedListItemWidth=draggedListItem.outerWidth(),draggedListItemHeight=draggedListItem.outerHeight(),listScroll=$("#wcp-editor-right").scrollTop()}),$(document).off("mousemove.wcp-editor-list-item-reorder"),$(document).on("mousemove.wcp-editor-list-item-reorder",function(e){var dx=Math.abs(e.pageX-iex),dy=Math.abs(e.pageY-iey);if(!didStartDragging&&shouldStartDragging&&(dx>dragThreshold||dy>dragThreshold)){didStartDragging=!0,listItemCopy=draggedListItem.clone(),listItemCopy.addClass("wcp-editor-dragged-list-item"),listItemCopy.css({width:draggedListItemWidth,left:draggedListItem.offset().left,top:draggedListItem.offset().top}),ix=draggedListItem.offset().left,iy=draggedListItem.offset().top,$("body").prepend(listItemCopy),listItemCopy.wrap('<div class="wcp-editor-dragged-list-item-wrap"></div>');for(var tempElHtml='<div id="wcp-editor-list-item-invisible-tmp" style="width: '+draggedListItemWidth+"px; height: "+draggedListItemHeight+'px; position: relative;"></div>',numberOfListItems=$("#wcp-editor-right .wcp-editor-list-item").length,i=0;i<numberOfListItems;i++)$('#wcp-editor-right .wcp-editor-list-item[data-wcp-editor-list-item-index="'+i+'"]').before(tempElHtml),dragMap.push($("#wcp-editor-list-item-invisible-tmp").offset().top+draggedListItemHeight/2),$("#wcp-editor-list-item-invisible-tmp").remove();draggedListItem.hide()}if(didStartDragging){clearSelection(),listItemCopy.css({left:ix-(iex-e.pageX),top:iy-(iey-e.pageY)});for(var closestIndex=-1,smallestDistance=99999,listItemCopyOffsetTop=listItemCopy.offset().top+draggedListItemHeight/2,i=0;i<dragMap.length;i++){var distance=Math.abs(listItemCopyOffsetTop-dragMap[i]);distance<smallestDistance&&(smallestDistance=distance,closestIndex=i)}if(currentItemIndex!=closestIndex){$("#wcp-editor-list-item-visible-tmp").remove();var visibleDummyElementHTML='<div id="wcp-editor-list-item-visible-tmp" style="width: '+draggedListItemWidth+"px; height: "+draggedListItemHeight+'px;"><div id="wcp-editor-list-item-visible-tmp-inner"></div></div>';closestIndex<startingItemIndex?$('#wcp-editor-right .wcp-editor-list-item[data-wcp-editor-list-item-index="'+closestIndex+'"]').before(visibleDummyElementHTML):$('#wcp-editor-right .wcp-editor-list-item[data-wcp-editor-list-item-index="'+closestIndex+'"]').after(visibleDummyElementHTML),currentItemIndex=closestIndex}$("#wcp-editor-right").scrollTop(listScroll)}}),$(document).off("mouseup.wcp-editor-list-item-reorder"),$(document).on("mouseup.wcp-editor-list-item-reorder",function(){didStartDragging&&($(".wcp-editor-dragged-list-item-wrap").remove(),$("#wcp-editor-list-item-visible-tmp").remove(),draggedListItem.show(),$.wcpEditorEventListItemMoved(draggedListItem.attr("id"),startingItemIndex,currentItemIndex)),shouldStartDragging=!1,didStartDragging=!1,startingItemIndex=-1,currentItemIndex=-1,dragMap=[]})},WCPEditor.prototype.openMainTabWithName=function(tabName){$(".wcp-editor-main-tab-content").hide(),$('[data-wcp-main-tab-content-name="'+tabName+'"]').show(),$(".wcp-editor-main-tab-button").removeClass("wcp-active"),$('[data-wcp-main-tab-button-name="'+tabName+'"]').addClass("wcp-active")},WCPEditor.prototype.presentModal=function(options){if(clearTimeout(this.modalTimeout),0==$("#wcp-editor-modal").length){var html="";html+='<div id="wcp-editor-modal">',html+='   <div class="wcp-editor-modal-body">',html+='       <div class="wcp-editor-modal-close"><i class="fa fa-times" aria-hidden="true"></i></div>',html+='       <div class="wcp-editor-modal-header"></div>',html+='       <div class="wcp-editor-modal-content"></div>',html+='       <div class="wcp-editor-modal-footer"></div>',html+="       </div>",html+="   </div>",html+="</div>",$("body").append(html),this.modal=$("#wcp-editor-modal")}this.modal||(this.modal=$("#wcp-editor-modal")),this.modal.data("wcp-editor-modal-name",options.name),this.modal.find(".wcp-editor-modal-header").html(options.title),this.modal.find(".wcp-editor-modal-content").html(options.body);for(var buttonHtml="",i=0;i<options.buttons.length;i++){var buttonClass="",buttonId="";"primary"==options.buttons[i].class&&(buttonClass="wcp-editor-modal-button-primary"),"danger"==options.buttons[i].class&&(buttonClass="wcp-editor-modal-button-danger"),options.buttons[i].id&&(buttonId=options.buttons[i].id),buttonHtml+='<div class="wcp-editor-modal-button '+buttonClass+'" id="'+buttonId+'" data-wcp-editor-modal-button-name="'+options.buttons[i].name+'">'+options.buttons[i].title+"</div>"}this.modal.find(".wcp-editor-modal-footer").html(buttonHtml);var self=this;self.modal.css({display:"flex"}),setTimeout(function(){self.modal.addClass("wcp-editor-modal-visible")},10)},WCPEditor.prototype.closeModal=function(){var self=this;this.modal.removeClass("wcp-editor-modal-visible"),this.modalTimeout=setTimeout(function(){self.modal.hide()},330)},WCPEditor.prototype.presentCreateNewModal=function(){var modalBody="";modalBody+='<div class="wcp-editor-form-control">',modalBody+='  <label for="wcp-editor-input-create-new">Name: </label>',modalBody+='  <input type="text" id="wcp-editor-input-create-new">',modalBody+='  <div id="wcp-editor-create-new-error">Please enter a name!</div>',modalBody+="</div>";var modalOptions={name:"create_new",title:"Create New",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"create",title:"Create",class:"primary",id:"wcp-editor-button-create-new-instance"}],body:modalBody};this.presentModal(modalOptions),$("#wcp-editor-input-create-new").get(0).focus()},WCPEditor.prototype.presentLoadModal=function(){var self=this;this.presentLoadingScreenWithText("Loading Saves..."),$.wcpEditorGetSaves(function(savesList){for(var modalBody="",i=0;i<savesList.length;i++)modalBody+='  <div class="wcp-editor-save-list-item-wrap" data-wcp-editor-save-list-item-name="'+savesList[i].name+'" data-wcp-editor-save-list-item-id="'+savesList[i].id+'">',modalBody+='      <div class="wcp-editor-save-list-item">'+savesList[i].name+"</div>",modalBody+='      <div class="wcp-editor-save-list-item-delete-button"><i class="fa fa-trash-o" aria-hidden="true"></i></div>',modalBody+="  </div>";var modalOptions={name:"load",title:"Load",buttons:[{name:"cancel",title:"Cancel",class:""}],body:modalBody};self.hideLoadingScreen(),self.presentModal(modalOptions)})},WCPEditor.prototype.presentDeleteSaveConfirmationModal=function(){var modalOptions={name:"confirmation",title:"Delete Save",buttons:[{name:"cancel",title:"Cancel",class:"",id:"wcp-editor-cancel-delete-save"},{name:"delete",title:"Delete",class:"danger",id:"wcp-editor-confirm-delete-save"}],body:"Are you sure you want to permanently delete this save?"};this.presentModal(modalOptions)},WCPEditor.prototype.presentImportModal=function(){var html="";html+='<div class="wcp-editor-form-control">',html+='   <label for="wcp-editor-textarea-import">Paste code to import:</label>',html+='   <textarea id="wcp-editor-textarea-import"></textarea>',html+='  <div id="wcp-editor-import-error">Invalid code!</div>',html+="</div>";var modalOptions={name:"import",title:"Import",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"import",title:"Import",class:"primary",id:"wcp-editor-confirm-import"}],body:html};this.presentModal(modalOptions),$("#wcp-editor-textarea-import").get(0).focus()},WCPEditor.prototype.presentExportModal=function(){var html="";html+='<div class="wcp-editor-form-control">',html+='   <label for="wcp-editor-textarea-export">Copy this code to import it later:</label>',html+='   <textarea id="wcp-editor-textarea-export">'+$.wcpEditorGetExportJSON()+"</textarea>",html+="</div>";var modalOptions={name:"export",title:"Export",buttons:[{name:"cancel",title:"Done",class:"primary"}],body:html};this.presentModal(modalOptions),$("#wcp-editor-textarea-export").get(0).select()},WCPEditor.prototype.setContentForTabWithName=function(tabName,content){$('.wcp-editor-main-tab-content[data-wcp-main-tab-content-name="'+tabName+'"]').find(".wcp-editor-main-tab-content-inner-wrap").html(content)},WCPEditor.prototype.setContentForCanvas=function(content){$("#wcp-editor-canvas").html(content)},WCPEditor.prototype.setListItems=function(listItems){for(var buttonsHTML="",i=0;i<this.options.listItemButtons.length;i++){var b=this.options.listItemButtons[i];buttonsHTML+='<div class="wcp-editor-list-item-button" data-wcp-editor-list-item-button-name="'+b.name+'" data-wcp-tooltip="'+b.title+'" data-wcp-tooltip-position="bottom">',buttonsHTML+='    <i class="'+b.icon+'" aria-hidden="true"></i>',buttonsHTML+="</div>"}for(var html="",i=0;i<listItems.length;i++)html+='<div class="wcp-editor-list-item" id="wcp-editor-list-item-'+listItems[i].id+'" data-wcp-editor-list-item-index="'+i+'" data-wcp-editor-list-item-id="'+listItems[i].id+'">',html+='   <div class="wcp-editor-list-item-title">'+listItems[i].title+"</div>",html+='   <div class="wcp-editor-list-item-buttons">'+buttonsHTML+"</div>",html+="</div>";$("#wcp-editor-right").html(html)},WCPEditor.prototype.selectListItem=function(listItemId){$(".wcp-editor-list-item").removeClass("wcp-active"),$("#wcp-editor-list-item-"+listItemId).addClass("wcp-active")},WCPEditor.prototype.showTooltip=function(element,text,tooltipPosition){0==$("#wcp-editor-tooltip").length&&($("body").append('<div id="wcp-editor-tooltip"></div>'),this.tooltip=$("#wcp-editor-tooltip")),this.tooltip||(this.tooltip=$("#wcp-editor-tooltip")),this.tooltip.html(text),this.tooltip.show();var x=0,y=0,tooltipSpacing=12;"left"==tooltipPosition&&(x=element.offset().left-this.tooltip.outerWidth()-tooltipSpacing,y=element.offset().top+element.outerHeight()/2-this.tooltip.outerHeight()/2),"right"==tooltipPosition&&(x=element.offset().left+element.outerWidth()+tooltipSpacing,y=element.offset().top+element.outerHeight()/2-this.tooltip.outerHeight()/2),"top"==tooltipPosition&&(x=element.offset().left+element.outerWidth()/2-this.tooltip.outerWidth()/2,y=element.offset().top-this.tooltip.outerHeight()-tooltipSpacing),"bottom"==tooltipPosition&&(x=element.offset().left+element.outerWidth()/2-this.tooltip.outerWidth()/2,y=element.offset().top+element.outerHeight()+tooltipSpacing),this.tooltip.css({left:x,top:y}),"left"==tooltipPosition&&(this.tooltip.removeClass("wcp-editor-tooltip-left"),this.tooltip.removeClass("wcp-editor-tooltip-right"),this.tooltip.removeClass("wcp-editor-tooltip-top"),this.tooltip.removeClass("wcp-editor-tooltip-bottom"),this.tooltip.addClass("wcp-editor-tooltip-left")),"right"==tooltipPosition&&(this.tooltip.removeClass("wcp-editor-tooltip-left"),this.tooltip.removeClass("wcp-editor-tooltip-right"),this.tooltip.removeClass("wcp-editor-tooltip-top"),this.tooltip.removeClass("wcp-editor-tooltip-bottom"),this.tooltip.addClass("wcp-editor-tooltip-right")),"top"==tooltipPosition&&(this.tooltip.removeClass("wcp-editor-tooltip-left"),this.tooltip.removeClass("wcp-editor-tooltip-right"),this.tooltip.removeClass("wcp-editor-tooltip-top"),this.tooltip.removeClass("wcp-editor-tooltip-bottom"),this.tooltip.addClass("wcp-editor-tooltip-top")),"bottom"==tooltipPosition&&(this.tooltip.removeClass("wcp-editor-tooltip-left"),this.tooltip.removeClass("wcp-editor-tooltip-right"),this.tooltip.removeClass("wcp-editor-tooltip-top"),this.tooltip.removeClass("wcp-editor-tooltip-bottom"),this.tooltip.addClass("wcp-editor-tooltip-bottom")),this.tooltip.offset().left+this.tooltip.outerWidth()>window.innerWidth&&this.tooltip.css({left:window.innerWidth-this.tooltip.outerWidth()}),this.tooltip.offset().left<0&&this.tooltip.css({left:0}),this.tooltip.offset().top+this.tooltip.outerHeight()>window.innerHeight&&this.tooltip.css({top:window.innerHeight-this.tooltip.outerHeight()}),this.tooltip.offset().top<0&&this.tooltip.css({top:0}),this.tooltip.addClass("wcp-editor-tooltip-visible")},WCPEditor.prototype.hideTooltip=function(){this.tooltip.hide(),this.tooltip.removeClass("wcp-editor-tooltip-visible")},WCPEditor.prototype.presentLoadingScreenWithText=function(text){if(clearTimeout(this.loadingScreenTimeout),0==$("#wcp-editor-loading-screen").length){var html="";html+='<div id="wcp-editor-loading-screen">',html+='   <div id="wcp-editor-loading-screen-icon"><i class="fa fa-circle-o-notch fa-spin"></i></div>',html+='   <div id="wcp-editor-loading-screen-text"></div>',html+="</div>",$("body").append(html),this.loadingScreen=$("#wcp-editor-loading-screen")}this.loadingScreen||(this.loadingScreen=$("#wcp-editor-loading-screen")),this.loadingScreen.css({display:"flex"}),$("#wcp-editor-loading-screen-icon").html('<i class="fa fa-circle-o-notch fa-spin"></i>'),$("#wcp-editor-loading-screen-text").html(text);var self=this;setTimeout(function(){self.loadingScreen.addClass("wcp-editor-loading-screen-visible")},10)},WCPEditor.prototype.updateLoadingScreenMessage=function(text){$("#wcp-editor-loading-screen-text").html(text)},WCPEditor.prototype.hideLoadingScreen=function(){this.loadingScreen||(this.loadingScreen=$("#wcp-editor-loading-screen")),this.loadingScreen.removeClass("wcp-editor-loading-screen-visible");var self=this;this.loadingScreenTimeout=setTimeout(function(){self.loadingScreen.hide()},250)},WCPEditor.prototype.hideLoadingScreenWithText=function(text,error){var self=this;$("#wcp-editor-loading-screen-text").html(text),error?$("#wcp-editor-loading-screen-icon").html('<i class="fa fa-times"></i>'):$("#wcp-editor-loading-screen-icon").html('<i class="fa fa-check"></i>'),setTimeout(function(){self.hideLoadingScreen()},1e3)},WCPEditor.prototype.selectTool=function(toolName){$(".wcp-editor-toolbar-button").removeClass("wcp-active"),$('[data-wcp-editor-toolbar-button-name="'+toolName+'"]').addClass("wcp-active"),$.wcpEditorEventSelectedTool(toolName)},WCPEditor.prototype.setPreviewModeOn=function(){$("#wcp-editor-button-preview").addClass("wcp-active")},WCPEditor.prototype.setPreviewModeOff=function(){$("#wcp-editor-button-preview").removeClass("wcp-active")},WCPEditorForm.prototype.init=function(){for(var i=0;i<this.options.controlGroups.length;i++)for(var j=0;j<this.options.controlGroups[i].controls.length;j++){var controlOptions=this.options.controlGroups[i].controls[j],controlRegisteredSettings=$.extend(!0,{},registeredControls[controlOptions.type]),self=this,c=new WCPEditorControl(controlOptions,controlRegisteredSettings,function(){self.controlUpdated(this.name)});c.setVal(controlOptions.value),this.controls[controlOptions.name]=c}this.events()},WCPEditorForm.prototype.events=function(controls){var self=this;$(document).on("click","#"+this.id+" [data-wcp-form-tab-button-name]",function(){var name=$(this).data("wcp-form-tab-button-name");self.openFormTabWithName(name)})},WCPEditorForm.prototype.openFormTabWithName=function(tabName){var formRoot=$("#"+this.id);formRoot.find(".wcp-editor-form-tab-content").hide(),formRoot.find('[data-wcp-form-tab-content-name="'+tabName+'"]').show(),formRoot.find(".wcp-editor-form-tab-button").removeClass("wcp-active"),formRoot.find('[data-wcp-form-tab-button-name="'+tabName+'"]').addClass("wcp-active"),this.updateForm(),this.selectedTab=formRoot.find('[data-wcp-form-tab-button-name="'+tabName+'"]').data("wcp-form-tab-button-index")},WCPEditorForm.prototype.getFormHTML=function(){var html="",tabsHTML="",tabsContentsHTML="";tabsHTML+='<div class="wcp-editor-form-tabs-wrap">',tabsContentsHTML+='<div class="wcp-editor-form-tabs-content-wrap">';for(var i=0;i<this.options.controlGroups.length;i++){var controlGroup=this.options.controlGroups[i],buttonClass="";i==this.selectedTab&&(buttonClass="wcp-active"),tabsHTML+='<div class="wcp-editor-form-tab-button '+buttonClass+'" data-wcp-form-tab-button-name="'+controlGroup.groupName+'" data-wcp-form-tab-button-index="'+i+'">',tabsHTML+='   <div class="wcp-editor-form-tab-button-icon"><i class="'+controlGroup.groupIcon+'" aria-hidden="true"></i></div>',tabsHTML+='   <div class="wcp-editor-form-tab-button-text">'+controlGroup.groupTitle+"</div>",tabsHTML+="</div>";var contentStyle="display: none;";i==this.selectedTab&&(contentStyle=""),tabsContentsHTML+='<div class="wcp-editor-form-tab-content" data-wcp-form-tab-content-name="'+controlGroup.groupName+'" style="'+contentStyle+'">';for(var j=0;j<controlGroup.controls.length;j++){var control=controlGroup.controls[j],tooltipAttributes="";control.tooltip&&(tooltipAttributes='data-wcp-tooltip="'+control.tooltip.text+'" data-wcp-tooltip-position="'+control.tooltip.position+'"'),tabsContentsHTML+='<div class="wcp-editor-form-control" id="wcp-editor-form-control-'+control.name+'" '+tooltipAttributes+">",this.controls[control.name].customLabel||(tabsContentsHTML+="   <label>"+control.title+"</label>"),tabsContentsHTML+=this.controls[control.name].HTML(),tabsContentsHTML+="</div>"}tabsContentsHTML+="</div>"}return tabsContentsHTML+="</div>",tabsHTML+="</div>",html='<div class="wcp-editor-form-wrap" id="'+this.id+'">'+tabsHTML+tabsContentsHTML+"</div>"},WCPEditorForm.prototype.controlUpdated=function(controlName){$.wcpEditorEventFormUpdated(this.options.name,controlName)},WCPEditorForm.prototype.updateForm=function(){for(var c in this.controls)this.controls[c].loadVal()},WCPEditorForm.prototype.getModel=function(){for(var model={},i=0;i<this.options.controlGroups.length;i++){var controlGroupName=this.options.controlGroups[i].groupName;model[controlGroupName]={};for(var j=0;j<this.options.controlGroups[i].controls.length;j++){var controlName=this.options.controlGroups[i].controls[j].name,controlValue=this.controls[controlName].getVal();model[controlGroupName][controlName]=controlValue}}return model},WCPEditorForm.prototype.setControlValue=function(controlName,v){this.controls[controlName]&&this.controls[controlName].getVal()!==v&&this.controls[controlName].setVal(v)},WCPEditorForm.prototype.showControlsGroup=function(groupName){$("#"+this.id);$('[data-wcp-form-tab-button-name="'+groupName+'"]').show()},WCPEditorForm.prototype.hideControlsGroup=function(groupName){var formRoot=$("#"+this.id);formRoot.find('[data-wcp-form-tab-button-name="'+groupName+'"]').hide(),this.selectedTab==formRoot.find('[data-wcp-form-tab-button-name="'+groupName+'"]').data("wcp-form-tab-button-index")&&(this.selectedTab=0,this.openFormTabWithName(formRoot.find('[data-wcp-form-tab-button-index="0"]').data("wcp-form-tab-button-name")))},WCPEditorForm.prototype.showControl=function(controlName){var formRoot=$("#"+this.id);formRoot.find("#wcp-editor-form-control-"+controlName).show()},WCPEditorForm.prototype.hideControl=function(controlName){var formRoot=$("#"+this.id);formRoot.find("#wcp-editor-form-control-"+controlName).hide()},WCPEditorForm.prototype.addControl=function(controlGroupName,controlOptions){for(var i=0;i<this.options.controlGroups.length;i++){var controlGroup=this.options.controlGroups[i];if(controlGroup.groupName==controlGroupName){controlGroup.controls.push(controlOptions);break}}var controlRegisteredSettings=$.extend(!0,{},registeredControls[controlOptions.type]),self=this,c=new WCPEditorControl(controlOptions,controlRegisteredSettings,function(){self.controlUpdated(this.name)});c.setVal(controlOptions.value),this.controls[controlOptions.name]=c},WCPEditorForm.prototype.removeControl=function(controlName){delete this.controls[controlName];for(var i=0;i<this.options.controlGroups.length;i++){for(var controlGroup=this.options.controlGroups[i],done=!1,j=0;j<controlGroup.controls.length;j++){var control=controlGroup.controls[j];
if(control.name==controlName){controlGroup.controls.splice(j,1),done=!0;break}}if(done)break}},WCPEditorControl.prototype.getVal=function(){return this._value},WCPEditorControl.prototype.setVal=function(v){this._value=v;try{this.setValue(v)}catch(err){console.log(err)}},WCPEditorControl.prototype.loadVal=function(){this.setValue(this._value)},WCPEditorControl.prototype.valueChanged=function(){this._value=this.getValue(),this.valueUpdated()},$.wcpEditorInit=function(options){var defaultOptions={canvasFill:!1,canvasWidth:800,canvasHeight:600,mainTabs:[],toolbarButtons:[],extraMainButtons:[],listItemButtons:[],newButton:!0,previewToggle:!0};wcpEditor=new WCPEditor,wcpEditor.init($.extend(!0,{},defaultOptions,options))},$.wcpEditorRegisterControl=function(options){registeredControls[options.type]=options},$.wcpEditorCreateForm=function(options){wcpForms[options.name]=new WCPEditorForm(options),wcpForms[options.name].init()},$.wcpEditorUpdateForm=function(formName){wcpForms[formName].updateForm()},$.wcpEditorFormAddControl=function(formName,controlGroupName,controlOptions){wcpForms[formName].addControl(controlGroupName,controlOptions)},$.wcpEditorFormRemoveControl=function(formName,controlName){wcpForms[formName].removeControl(controlName)},$.wcpEditorFormOpenTab=function(formName,tabName){wcpForms[formName].openFormTabWithName(tabName)},$.wcpEditorGetHTMLForFormWithName=function(formName){return wcpForms[formName].getFormHTML()},$.wcpEditorGetModelOfFormWithName=function(formName){return wcpForms[formName].getModel()},$.wcpEditorSetControlValue=function(formName,controlName,v){wcpForms[formName].setControlValue(controlName,v)},$.wcpEditorFormShowControlsGroup=function(formName,groupName){wcpForms[formName].showControlsGroup(groupName)},$.wcpEditorFormHideControlsGroup=function(formName,groupName){wcpForms[formName].hideControlsGroup(groupName)},$.wcpEditorFormShowControl=function(formName,controlName){wcpForms[formName].showControl(controlName)},$.wcpEditorFormHideControl=function(formName,controlName){wcpForms[formName].hideControl(controlName)},$.wcpEditorSetContentForTabWithName=function(tabName,content){wcpEditor.setContentForTabWithName(tabName,content)},$.wcpEditorOpenMainTabWithName=function(tabName){wcpEditor.openMainTabWithName(tabName)},$.wcpEditorSetContentForCanvas=function(content){wcpEditor.setContentForCanvas(content)},$.wcpEditorSetListItems=function(listItems){wcpEditor.setListItems(listItems)},$.wcpEditorSelectListItem=function(listItemId){wcpEditor.selectListItem(listItemId)},$.wcpEditorSelectTool=function(toolName){wcpEditor.selectTool(toolName)},$.wcpEditorPresentLoadingScreen=function(text){wcpEditor.presentLoadingScreenWithText(text)},$.wcpEditorUpdateLoadingScreenMessage=function(text){wcpEditor.updateLoadingScreenMessage(text)},$.wcpEditorHideLoadingScreen=function(){wcpEditor.hideLoadingScreen()},$.wcpEditorHideLoadingScreenWithMessage=function(text,error){wcpEditor.hideLoadingScreenWithText(text,error)},$.wcpEditorPresentLoadModal=function(){wcpEditor.presentLoadModal()},$.wcpEditorPresentModal=function(options){var modalDefaults={title:"",buttons:[],body:""};wcpEditor.presentModal($.extend(!0,{},modalDefaults,options))},$.wcpEditorCloseModal=function(){wcpEditor.closeModal()},$.wcpEditorSetPreviewModeOn=function(){wcpEditor.setPreviewModeOn()},$.wcpEditorSetPreviewModeOff=function(){wcpEditor.setPreviewModeOff()},$.wcpEditorGetContentForTabWithName=function(tabName){},$.wcpEditorGetContentForCanvas=function(){},$.wcpEditorGetListItems=function(){},$.wcpEditorGetSaves=function(callback){},$.wcpEditorGetExportJSON=function(){return"{}"},$.wcpEditorEventFormUpdated=function(formName,controlName){},$.wcpEditorEventNewButtonPressed=function(){},$.wcpEditorEventSaveButtonPressed=function(){},$.wcpEditorEventLoadButtonPressed=function(){},$.wcpEditorEventUndoButtonPressed=function(){},$.wcpEditorEventRedoButtonPressed=function(){},$.wcpEditorEventPreviewButtonPressed=function(){},$.wcpEditorEventEnteredPreviewMode=function(){},$.wcpEditorEventExitedPreviewMode=function(){},$.wcpEditorEventListItemMouseover=function(itemID){},$.wcpEditorEventListItemSelected=function(itemID){},$.wcpEditorEventListItemMoved=function(itemID,oldIndex,newIndex){},$.wcpEditorEventListItemButtonPressed=function(itemID,buttonName){},$.wcpEditorEventSelectedTool=function(toolName){},$.wcpEditorEventExtraMainButtonClick=function(buttonName){},$.wcpEditorEventModalButtonClicked=function(modalName,buttonName){},$.wcpEditorEventModalClosed=function(modalName){},$.wcpEditorEventCreatedNewInstance=function(instanceName){},$.wcpEditorEventLoadSaveWithID=function(saveID){},$.wcpEditorEventDeleteSaveWithID=function(saveID){},$.wcpEditorEventImportedJSON=function(parsedJSON){},$.wcpEditorEventHelpButtonPressed=function(){}}(jQuery,window,document);