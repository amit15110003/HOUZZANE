!function($,window,document,undefined){function Squares(host,settings){this.host=$(host),this.id=Math.floor(9999*Math.random())+1,this.settings=$.extend(!0,{},squaresDefaultSettings),this.contentRoot=undefined,this.root=undefined,this.Window=undefined,this.ix=0,this.iy=0,this.iex=0,this.iey=0,this.shouldStartDraggingContainer=!1,this.didStartDraggingContainer=!1,this.draggingContainer=!1,this.draggedContainerIndex=0,this.draggedContainer=undefined,this.dummyContainer=undefined,this.containerReorderMap=undefined,this.newIndexOfDraggedContainer=0,this.shouldStartDraggingElement=!1,this.didStartDraggingElement=!1,this.draggingElement=!1,this.draggedElementIndex=-1,this.draggedElementContainerIndex=-1,this.elementDragMap=undefined,this.dummyElement=undefined,this.newIndexOfDraggedElement=-1,this.draggedElementWidth=-1,this.selectedElementID=undefined,this.loadSettings(settings),this.init()}function Container(){this.id="sq-container-"+Math.floor(99999*Math.random())+1,this.settings=$.extend(!0,{},containerDefaultSettings)}function Element(settings,options){this.id="sq-element-"+Math.floor(99999*Math.random())+1,this.settings=$.extend(!0,{},elementDefaultSettings,settings),this.defaults=new Array,this.controls=new Array,this.content=this.settings.content,this.fontStyles="",this.init(options)}function EditorWindow(){this.root=undefined,this.id=Math.floor(1e4*Math.random())+1,this.visible=!1,this.shouldStartDragging=!1,this.didStartDragging=!1,this.dragging=!1,this.iex=0,this.iey=0,this.ix=0,this.iy=0,this.init(),this.events(),this.show(600,100)}function SquaresControl(s,name,group,tabGroup,options,valueUpdated){this.id=Math.floor(9999*Math.random())+1,this.elementID="sq-control-"+this.id,this.elementClass="sq-element-option-group",this.type=s.type,this.getValue=s.getValue,this.setValue=s.setValue,this.HTML=s.HTML,this.name=name,this.options=options,this.group=group,this.tabGroup=tabGroup,this._value=undefined,this.group!==undefined&&(this.elementClass="sq-element-option-group-"+this.group.toLowerCase().replace(/\s/g,"-")),this.init=s.init,this.init(),this.valueUpdated=valueUpdated,this.customLabel=s.customLabel}function hexToRgb(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null}function subtract(a,b){var r={};for(var key in b)"object"==typeof b[key]?(a[key]||(a[key]={}),r[key]=subtract(a[key],b[key])):b[key]!=a[key]&&(r[key]=a[key]);return r}function clean(a){var r=undefined;if("object"==typeof a)if(isEmpty(a))r=undefined;else for(var key in a){var cleaned=clean(a[key]);cleaned!==undefined&&(r===undefined&&(r={}),r[key]=cleaned)}else r=a;return r}function isEmpty(obj){for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return JSON.stringify(obj)===JSON.stringify({})}function getWidthOfElementInGrid(span){var columnWidth=8.33333333,elementWidth=columnWidth*span;return elementWidth+"%"}function isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)}var editorWindow=undefined,registeredElements=new Array,registeredControls=new Array,editors=new Array;$.squaresInitWithSettings=function(host,settings){if(host.data.editor)for(var i=0;i<editors.length;i++)editors[i].id==host.data.editor.id&&editors.splice(i,1);var squaresInstance=new Squares(host,JSON.parse(settings));editors.push(squaresInstance)},$.squaresGetCurrentSettings=function(host){return host.data.editor.generateJSON()},$.squaresGenerateHTML=function(host){return host.data.editor.generateHTML()},$.squaresRegisterElement=function(options){registeredElements.push(options)},$.squaresRegisterControl=function(options){registeredControls.push(options)},$.squaresShowEditorWindow=function(x,y){editorWindow.show(x,y)},$.squaresHideEditorWindow=function(){editorWindow.hide()},$.squaresExtendElementDefaults=function(extendedDefaults){elementDefaultSettings=$.extend(!0,{},elementDefaultSettings,extendedDefaults)},$(document).ready(function(){$(".squares").each(function(){var squaresInstance=new Squares(this);editors.push(squaresInstance),$(this).data.editor=squaresInstance})});var squaresDefaultSettings={containers:[]};Squares.prototype.loadSettings=function(settings){if(settings&&settings.containers)for(var i=0;i<settings.containers.length;i++){var c=settings.containers[i],newContainer=this.appendContainer();if(c.settings.elements)for(var j=0;j<c.settings.elements.length;j++)for(var e=c.settings.elements[j],k=0;k<registeredElements.length;k++)e.settings.name==registeredElements[k].name&&newContainer.insertElement(k,j,e.options)}},Squares.prototype.init=function(){this.host.data.editor=this,this.host.html(""),this.host.append('<div class="sq-root-container"></div>'),this.root=this.host.find(".sq-root-container"),this.host.find(".sq-root-container").append('<div class="sq-content"></div>'),this.contentRoot=this.host.find(".sq-content"),this.contentRoot.attr("id","sq-editor-"+this.id),this.addUI(),this.addEvents(),this.redraw(),editorWindow=new EditorWindow,editorWindow.hide()},Squares.prototype.redraw=function(){this.contentRoot.html("");for(var i=0;i<this.settings.containers.length;i++){var c=this.settings.containers[i],html='<div class="sq-container" data-index="'+i+'" id="'+c.id+'"></div>';this.contentRoot.append(html);var containerRoot=$("#"+c.id);c.render(),c.appendEditorControls();for(var j=0;j<c.settings.elements.length;j++){var e=c.settings.elements[j],html='<div class="sq-element" data-index="'+j+'" id="'+e.id+'"></div>';containerRoot.append(html),e.render(),e.appendEditorControls()}containerRoot.append('<div class="squares-clear"></div>')}0==this.settings.containers.length?this.root.find(".sq-add-elements").hide():this.root.find(".sq-add-elements").show(),this.selectedElementID&&this.selectElement(this.selectedElementID)},Squares.prototype.addEvents=function(){var self=this;this.host.find(".sq-add-container").off("click"),this.host.find(".sq-add-container").on("click",function(){self.appendContainer(),self.redraw()}),$(document).off("mouseout","#sq-editor-"+this.id+" .sq-container"),$(document).on("mouseout","#sq-editor-"+this.id+" .sq-container",function(e){0!=$(e.target).closest(".sq-container-confirm-delete").length||$(e.target).hasClass("sq-container-confirm-delete")||0!=$(e.target).closest(".sq-container-delete").length||$(e.target).hasClass("sq-container-delete")||$(".sq-container-confirm-delete").hide()}),$(document).off("click","#sq-editor-"+this.id+" .sq-container-delete"),$(document).on("click","#sq-editor-"+this.id+" .sq-container-delete",function(){$(this).siblings(".sq-container-confirm-delete").show()}),$(document).off("click","#sq-editor-"+this.id+" .sq-container-confirm-delete"),$(document).on("click","#sq-editor-"+this.id+" .sq-container-confirm-delete",function(){self.deleteContainer($(this).data("container-id")),self.redraw()}),$(document).off("mousedown","#sq-editor-"+self.id+" .sq-container-move"),$(document).on("mousedown","#sq-editor-"+self.id+" .sq-container-move",function(e){self.settings.containers.length<=1||(self.iex=e.pageX,self.iey=e.pageY,self.shouldStartDraggingContainer=!0,self.draggedContainerIndex=$(e.target).closest(".sq-container").data("index"),self.draggedContainer=self.host.find(".sq-container[data-index="+self.draggedContainerIndex+"]"))}),$(document).off("mousedown","#sq-editor-"+self.id+" .sq-element"),$(document).on("mousedown","#sq-editor-"+self.id+" .sq-element",function(e){1==self.settings.containers.length&&1==self.settings.containers[0].settings.elements.length||(self.iex=e.pageX,self.iey=e.pageY,self.shouldStartDraggingElement=!0,self.draggedElement=$(this),self.draggedElementIndex=$(this).data("index"),self.draggedElementContainerIndex=$(this).closest(".sq-container").data("index"))}),$(document).off("mousemove."+self.id),$(document).on("mousemove."+self.id,function(e){self.shouldStartDraggingContainer&&!self.didStartDraggingContainer&&self.startDraggingContainer(e),self.draggingContainer&&self.dragContainer(e),self.shouldStartDraggingElement&&!self.didStartDraggingElement&&self.startDraggingElement(e),self.draggingElement&&self.dragElement(e)}),$(document).off("mouseup."+self.id),$(document).on("mouseup."+self.id,function(e){self.draggingContainer&&self.endDraggingContainer(e),self.draggingElement&&self.endDraggingElement(e),self.shouldStartDraggingContainer=!1,self.didStartDraggingContainer=!1,self.draggingContainer=!1,self.draggedContainerIndex=0,self.draggedContainer=undefined,self.dummyContainer=undefined,self.shouldStartDraggingElement=!1,self.didStartDraggingElement=!1,self.draggingElement=!1,self.draggedElementIndex=-1,self.draggedElementContainerIndex=-1}),$(document).off("click."+this.id,"#sq-delete-element-button"),$(document).on("click."+this.id,"#sq-delete-element-button",function(){for(var elementID=$(this).data("element-id"),i=0;i<self.settings.containers.length;i++)for(var c=self.settings.containers[i],j=0;j<c.settings.elements.length;j++)c.settings.elements[j].id==elementID&&(c.removeElementAtIndex(j),self.redraw())})},Squares.prototype.startDraggingContainer=function(e){if(Math.abs(e.pageX-this.iex)>5||Math.abs(e.pageY-this.iey)>5){this.draggingContainer=!0,this.didStartDraggingContainer=!0,this.containerReorderMap=new Array;for(var draggedContainerY=this.draggedContainer.outerHeight()/2,i=0;i<this.settings.containers.length;i++){for(var y=draggedContainerY,j=i-1;j>=0;j--){var index=j;j>=this.draggedContainerIndex&&index++;var c=this.host.find(".sq-container[data-index="+index+"]");y+=c.outerHeight()}this.containerReorderMap.push(y)}this.ix=this.draggedContainer.position().left,this.iy=this.draggedContainer.position().top,this.draggedContainer.css({position:"absolute",left:this.ix,top:this.iy,width:this.draggedContainer.width()}),this.draggedContainer.addClass("sq-dragging"),this.draggedContainer.after('<div id="sq-dummy-container"></div>'),this.dummyContainer=$("#sq-dummy-container"),this.dummyContainer.css({width:this.draggedContainer.outerWidth(),height:this.draggedContainer.outerHeight()})}},Squares.prototype.dragContainer=function(e){this.draggedContainer.css({left:this.ix+e.pageX-this.iex,top:this.iy+e.pageY-this.iey});for(var y=this.draggedContainer.position().top+this.draggedContainer.outerHeight()/2,closestDeltaY=999999,closestIndex=undefined,i=0;i<this.containerReorderMap.length;i++)Math.abs(y-this.containerReorderMap[i])<closestDeltaY&&(closestDeltaY=Math.abs(y-this.containerReorderMap[i]),closestIndex=i);closestIndex!=this.newIndexOfDraggedContainer&&(this.newIndexOfDraggedContainer=closestIndex,this.dummyContainer.remove(),this.newIndexOfDraggedContainer<this.draggedContainerIndex?this.host.find(".sq-container[data-index="+this.newIndexOfDraggedContainer+"]").before('<div id="sq-dummy-container"></div>'):this.host.find(".sq-container[data-index="+this.newIndexOfDraggedContainer+"]").after('<div id="sq-dummy-container"></div>'),this.dummyContainer=$("#sq-dummy-container"),this.dummyContainer.css({width:this.draggedContainer.outerWidth(),height:this.draggedContainer.outerHeight()}))},Squares.prototype.endDraggingContainer=function(e){if(this.draggedContainerIndex!=this.newIndexOfDraggedContainer){var a=this.settings.containers[this.draggedContainerIndex];this.settings.containers.splice(this.draggedContainerIndex,1),this.settings.containers.splice(this.newIndexOfDraggedContainer,0,a)}this.redraw()},Squares.prototype.startDraggingElement=function(e){if(Math.abs(e.pageX-this.iex)>5||Math.abs(e.pageY-this.iey)>5){this.draggingElement=!0,this.didStartDraggingElement=!0,this.ix=this.draggedElement.offset().left,this.iy=this.draggedElement.offset().top,this.elementDragMap=new Array;var draggedElementObject=this.settings.containers[this.draggedElementContainerIndex].settings.elements[this.draggedElementIndex];this.draggedElementWidth=getWidthOfElementInGrid(draggedElementObject.controls.layout.column_span.getVal()),this.draggedElementWidth=this.draggedElement.outerWidth();var dummyElementHTML='<div id="sq-dummy-element-tmp" style="width: '+this.draggedElementWidth+"px; height: "+this.draggedElement.outerHeight()+'px;"></div>';this.draggedElement.hide();for(var i=0;i<this.settings.containers.length;i++){var c=this.settings.containers[i];if(0==c.settings.elements.length){this.host.find(".sq-container[data-index="+i+"]").append(dummyElementHTML);var el=$("#sq-dummy-element-tmp");this.elementDragMap.push({x:el.offset().left+el.width()/2,y:el.offset().top+el.height()/2,containerIndex:i,elementIndex:0}),$("#sq-dummy-element-tmp").remove()}for(var j=0;j<c.settings.elements.length;j++){this.host.find(".sq-container[data-index="+i+"]").find(".sq-element[data-index="+j+"]").before(dummyElementHTML);var el=$("#sq-dummy-element-tmp");if(this.elementDragMap.push({x:el.offset().left+el.width()/2,y:el.offset().top+el.height()/2,containerIndex:i,elementIndex:j}),$("#sq-dummy-element-tmp").remove(),j==c.settings.elements.length-1){this.host.find(".sq-container[data-index="+i+"]").find(".sq-element[data-index="+j+"]").after(dummyElementHTML);var el=$("#sq-dummy-element-tmp");this.elementDragMap.push({x:el.offset().left+el.width()/2,y:el.offset().top+el.height()/2,containerIndex:i,elementIndex:j+1}),$("#sq-dummy-element-tmp").remove()}}}this.draggedElement.show(),this.draggedElement.after('<div id="sq-dummy-element"><div id="sq-dummy-element-inner"></div></div>'),this.dummyElement=$("#sq-dummy-element"),this.dummyElement.css({width:this.draggedElementWidth,height:this.draggedElement.outerHeight(),margin:this.draggedElement.css("margin"),padding:0});var draggedElementWidth=this.draggedElement.width(),draggedElementHeight=this.draggedElement.height(),draggedElementHTML=this.draggedElement.clone().attr("id","sq-dragged-element").wrap("<div>").parent().html();this.draggedElement.hide(),$("body").prepend(draggedElementHTML),this.draggedElement=$("#sq-dragged-element"),this.draggedElement.css({position:"absolute",left:this.ix,top:this.iy,width:draggedElementWidth,height:draggedElementHeight}),this.draggedElement.addClass("sq-dragging")}},Squares.prototype.dragElement=function(e){this.draggedElement.css({left:this.ix+e.pageX-this.iex,top:this.iy+e.pageY-this.iey});for(var closestIndex=0,closestDistance=999999,i=0;i<this.elementDragMap.length;i++){var d=Math.abs(e.pageX-this.elementDragMap[i].x)+Math.abs(e.pageY-this.elementDragMap[i].y);d<closestDistance&&(closestDistance=d,closestIndex=i)}if(closestIndex!=this.newIndexOfDraggedElement){this.newIndexOfDraggedElement=closestIndex,$("#sq-dummy-element").remove();var containerIndex=this.elementDragMap[this.newIndexOfDraggedElement].containerIndex,elementIndex=this.elementDragMap[this.newIndexOfDraggedElement].elementIndex,c=this.host.find(".sq-container[data-index="+containerIndex+"]");if(0==this.settings.containers[containerIndex].settings.elements.length)c.prepend('<div id="sq-dummy-element"><div id="sq-dummy-element-inner"></div></div>');else if(elementIndex==this.settings.containers[containerIndex].settings.elements.length){var lastElementIndex=this.settings.containers[containerIndex].settings.elements.length-1,el=c.find(".sq-element[data-index="+lastElementIndex+"]");el.after('<div id="sq-dummy-element"><div id="sq-dummy-element-inner"></div></div>')}else{var el=c.find(".sq-element[data-index="+elementIndex+"]");el.before('<div id="sq-dummy-element"><div id="sq-dummy-element-inner"></div></div>')}this.dummyElement=$("#sq-dummy-element"),this.dummyElement.css({width:this.draggedElementWidth,height:this.draggedElement.outerHeight(),margin:this.draggedElement.css("margin")})}},Squares.prototype.endDraggingElement=function(e){this.draggedElement.remove();var newContainerIndex=this.elementDragMap[this.newIndexOfDraggedElement].containerIndex,newElementIndex=this.elementDragMap[this.newIndexOfDraggedElement].elementIndex,oldElementIndex=this.draggedElementIndex,oldContainerIndex=this.draggedElementContainerIndex,el=this.settings.containers[oldContainerIndex].settings.elements[oldElementIndex];this.settings.containers[oldContainerIndex].settings.elements.splice(oldElementIndex,1),this.settings.containers[newContainerIndex].settings.elements.splice(newElementIndex,0,el),this.redraw()},Squares.prototype.addUI=function(){this.appendAddContainerButton(),this.appendAddElementsButton()},Squares.prototype.appendAddContainerButton=function(){var addContainerButtonHTML='<div class="sq-add-container"><i class="fa fa-plus"></i> <span>Add Container</span></div>';this.root.append(addContainerButtonHTML)},Squares.prototype.appendAddElementsButton=function(){var addElementsButtonHTML='<div class="sq-add-elements"><i class="fa fa-cube"></i></div>';this.root.append(addElementsButtonHTML)},Squares.prototype.appendContainer=function(){var c=new Container;return this.settings.containers.push(c),c},Squares.prototype.deleteContainer=function(id){for(var index=0,i=0;i<this.settings.containers.length;i++)this.settings.containers[i].id==id&&(index=i);this.settings.containers.splice(index,1)},Squares.prototype.addElement=function(containerIndex,elementIndex,elementCatalogIndex,elementControlOptions){var self=this;self.settings.containers[containerIndex].insertElement(elementCatalogIndex,elementIndex,elementControlOptions),self.redraw()},Squares.prototype.generateJSON=function(){for(var settings=$.extend(!0,{},this.settings),i=0;i<settings.containers.length;i++){for(var c=$.extend(!0,{},settings.containers[i]),j=0;j<c.settings.elements.length;j++){var e=$.extend(!0,{},c.settings.elements[j]);e.settings=subtract(e.settings,elementDefaultSettings),e.settings=clean(e.settings);var options=e.getCurrentOptions();options=subtract(options,e.defaults),options=clean(options),c.settings.elements[j]={settings:e.settings,options:options}}settings.containers[i]=c}return JSON.stringify(settings)},Squares.prototype.generateHTML=function(){for(var html="",i=0;i<this.settings.containers.length;i++){var c=this.settings.containers[i];html+=c.generateHTML()}return html=html.replace(/\\(.)/gm,"$1"),html=html.replace(/\n/gm,"<br>")},Squares.prototype.selectElement=function(elementID){this.selectedElementID=elementID,$(".sq-element-selected").removeClass("sq-element-selected"),$("#"+this.selectedElementID).addClass("sq-element-selected")};var containerDefaultSettings={elements:[]};Container.prototype.insertElement=function(elementCatalogIndex,index,options){var e=new Element(registeredElements[elementCatalogIndex],options);this.settings.elements.splice(index,0,e)},Container.prototype.removeElementAtIndex=function(i){this.settings.elements.splice(i,1),editorWindow.openFirstTab(),editorWindow.removeElementSettings()},Container.prototype.render=function(){},Container.prototype.appendEditorControls=function(){var html="";html+='     <div class="sq-container-move"></div>',html+='     <div class="sq-container-delete"><i class="fa fa-times" aria-hidden="true"></i></div>',html+='     <div class="sq-container-confirm-delete" data-container-id="'+this.id+'">Delete</div>',$("#"+this.id).append(html)},Container.prototype.generateHTML=function(){var html="";html+='<div class="squares-container">';for(var i=0;i<this.settings.elements.length;i++){var e=this.settings.elements[i];html+=e.generateHTML()}return html+='<div class="squares-clear"></div>',html+="</div>"};var elementDefaultSettings={name:"Untitled Element",iconClass:"fa fa-cube",controls:[],defaultControls:{layout:{box_model:{name:"Box Model",type:"box model",default:{margin:{top:0,bottom:0,left:0,right:0},padding:{top:10,bottom:10,left:10,right:10}}},use_grid:{name:"Use Grid System",type:"switch",default:1},column_span:{name:"Grid Settings",type:"grid system",group:"Layout Grid",default:{xs:{use:0,class:"col-xs-12",visible:0},sm:{use:0,class:"col-sm-12",visible:0},md:{use:0,class:"col-md-12",visible:1},lg:{use:1,class:"col-lg-12",visible:1}}},width:{name:"Width",type:"int",group:"Layout Manual",default:"100"},auto_width:{name:"Auto Width",type:"switch",group:"Layout Manual",default:1},height:{name:"Height",type:"int",group:"Layout Manual",default:"100"},auto_height:{name:"Auto Height",type:"switch",group:"Layout Manual",default:1}},style:{background_color:{name:"Background Color",type:"color",default:"#ffffff"},background_opacity:{name:"Background Opacity",type:"slider",options:{min:0,max:1},default:"0"},opacity:{name:"Opacity",type:"slider",options:{min:0,max:1},default:"1"},box_shadow:{name:"Box Shadow",type:"text",default:"none"},border_width:{name:"Border Width",type:"slider",options:{min:0,max:20,type:"int"},default:"0"},border_style:{name:"Border Style",type:"select",options:["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],default:"none"},border_color:{name:"Border Color",type:"color",default:"#000000"},border_opacity:{name:"Border Opacity",type:"slider",options:{min:0,max:1},default:"1"},border_radius:{name:"Border Radius",type:"slider",options:{min:0,max:100,type:"int"},default:"0"}},font:{font_family:{name:"Font Family",type:"text",default:"sans-serif"},font_size:{name:"Font Size",type:"text",format:"int",default:"14"},font_weight:{name:"Font Weight",type:"text",default:"normal"},font_style:{name:"Font Style",type:"select",options:["normal","italic","oblique","initial","inherit"],default:"normal"},line_height:{name:"Line Height",type:"text",format:"int",default:"22"},text_color:{name:"Text Color",type:"color",default:"#000000"},text_align:{name:"Text Align",type:"select",options:["left","right","center","justify","justify-all","start","end","match-parent","inherit","initial","unset"],default:"left"},text_decoration:{name:"Text Decoration",type:"select",options:["none","underline"],default:"none"},text_transform:{name:"Text Transform",type:"select",options:["none","capitalize","uppercase","lowercase","initial","inherit"],default:"none"},text_shadow:{name:"Text Shadow",type:"text",default:""}},general:{id:{name:"ID",type:"text",default:""},classes:{name:"Classes",type:"text",default:""},css:{name:"CSS",type:"text",default:""}}},defaultControlGroupIcons:{general:"fa fa-wrench",layout:"fa fa-th-large",font:"fa fa-font",style:"fa fa-paint-brush"},content:function(){return""}};Element.prototype.init=function(options){this.settings.controls=$.extend(!0,{},this.settings.controls,this.settings.defaultControls),this.settings.controlGroupIcons=$.extend(!0,{},this.settings.controlGroupIcons,this.settings.defaultControlGroupIcons),this.settings.useStyleControls===!1&&(this.settings.controls.style=undefined),this.settings.useFontControls===!1&&(this.settings.controls.font=undefined);for(var g in this.settings.controls)if(this.settings.controls.hasOwnProperty(g)){var group=this.settings.controls[g];this.defaults[g]||(this.defaults[g]={});for(var op in group)if(group.hasOwnProperty(op)){var option=group[op];this.defaults[g][op]=option.default}}for(var g in this.settings.controls)if(this.settings.controls.hasOwnProperty(g)){var group=this.settings.controls[g];for(var op in group)if(group.hasOwnProperty(op)){for(var option=group[op],controlOptions=undefined,i=0;i<registeredControls.length;i++)registeredControls[i].type==option.type&&(controlOptions=registeredControls[i]);var v=option.default;options!==undefined&&options[g]!==undefined&&options[g][op]!==undefined&&(v="object"==typeof options[g][op]?$.extend(!0,{},option.default,options[g][op]):options[g][op]),this.controls[g]===undefined&&(this.controls[g]={});var self=this;this.controls[g][op]=new SquaresControl(controlOptions,option.name,option.group,g,option.options,function(){self.updateForm(),self.render(),self.appendEditorControls()}),this.controls[g][op].setVal(v)}}},Element.prototype.getSettingsForm=function(){var html="";html+='<div id="sq-window-settings-sidebar">';var groupCount=0;for(var g in this.controls){var icon='<i class="fa fa-toggle-on" aria-hidden="true"></i>';this.settings.controlGroupIcons[g]&&(icon='<i class="'+this.settings.controlGroupIcons[g]+'" aria-hidden="true"></i>'),html+='<div class="sq-window-settings-sidebar-button" data-tab-index="'+groupCount+'" data-tab-group="sq-element-settings-tab-group" data-tab-button>',html+='   <div class="sq-window-settings-sidebar-button-icon">'+icon+"</div>",html+='   <div class="sq-window-settings-sidebar-button-title">'+g+"</div>",html+="</div>",groupCount++}html+='<div class="sq-window-settings-sidebar-button" data-tab-index="'+groupCount+'" data-tab-group="sq-element-settings-tab-group" data-tab-button>',html+='   <div class="sq-window-settings-sidebar-button-icon"><i class="fa fa-trash-o" aria-hidden="true"></i></div>',html+='   <div class="sq-window-settings-sidebar-button-title">Delete</div>',html+="</div>",html+="</div>",html+='<div class="sq-settings-window-content-wrap">';var groupCount=0;for(var g in this.controls){html+='<div class="sq-window-content" data-tab-content data-tab-index="'+groupCount+'" data-tab-group="sq-element-settings-tab-group">';var tabGroup=this.controls[g];groupCount++;for(var c in tabGroup){var control=tabGroup[c];html+='<div class="sq-form-control '+control.elementClass+'">',control.customLabel?html+=control.HTML():(html+='<label for="'+control.elementID+'">'+control.name+"</label>",html+=control.HTML()),html+="</div>"}html+="</div>"}return html+='<div class="sq-window-content" data-tab-content data-tab-index="'+groupCount+'" data-tab-group="sq-element-settings-tab-group">',html+='   <div class="sq-form-control">',html+="       <p>Delete Element?</p>",html+='       <div id="sq-delete-element-button" data-element-id="'+this.id+'">Delete</div>',html+="   </div>",html+="</div>",html+="</div>"},Element.prototype.loadOptions=function(){for(var g in this.controls){var tabGroup=this.controls[g];for(var c in tabGroup){var control=tabGroup[c];control.loadVal()}}this.updateForm()},Element.prototype.updateForm=function(){1==this.controls.layout.use_grid.getVal()?($("."+this.controls.layout.width.elementClass).hide(),$("."+this.controls.layout.column_span.elementClass).show()):($("."+this.controls.layout.width.elementClass).show(),$("."+this.controls.layout.column_span.elementClass).hide())},Element.prototype.generateStyles=function(){var css="",o=this.controls.layout;isNumeric(o.box_model.getVal().margin.top)&&(css+="margin-top: "+o.box_model.getVal().margin.top+"px; "),isNumeric(o.box_model.getVal().margin.bottom)&&(css+="margin-bottom: "+o.box_model.getVal().margin.bottom+"px; "),isNumeric(o.box_model.getVal().margin.left)&&(css+="margin-left: "+o.box_model.getVal().margin.left+"px; "),isNumeric(o.box_model.getVal().margin.right)&&(css+="margin-right: "+o.box_model.getVal().margin.right+"px; "),isNumeric(o.box_model.getVal().padding.top)&&(css+="padding-top: "+o.box_model.getVal().padding.top+"px; "),isNumeric(o.box_model.getVal().padding.bottom)&&(css+="padding-bottom: "+o.box_model.getVal().padding.bottom+"px; "),isNumeric(o.box_model.getVal().padding.left)&&(css+="padding-left: "+o.box_model.getVal().padding.left+"px; "),isNumeric(o.box_model.getVal().padding.right)&&(css+="padding-right: "+o.box_model.getVal().padding.right+"px; "),1==parseInt(o.use_grid.getVal(),10)||(1==parseInt(o.auto_width.getVal(),10)?css+="width: auto; ":""===o.width.getVal()||isNaN(o.width.getVal())||(css+="width: "+o.width.getVal()+"px; "),1==parseInt(o.auto_height.getVal(),10)?css+="height: auto; ":""===o.height.getVal()||isNaN(o.height.getVal())||(css+="height: "+o.height.getVal()+"px; ")),css+="float: left; ";var o=this.controls.font;o&&(""!==o.font_family.getVal()&&(css+="font-family: "+o.font_family.getVal()+"; ",this.fontStyles+="font-family: "+o.font_family.getVal()+"; "),isNumeric(o.font_size.getVal())&&(css+="font-size: "+o.font_size.getVal()+"px; ",this.fontStyles+="font-size: "+o.font_size.getVal()+"px; "),""!==o.font_weight.getVal()&&(css+="font-weight: "+o.font_weight.getVal()+"; ",this.fontStyles+="font-weight: "+o.font_weight.getVal()+"; "),""!==o.font_style.getVal()&&(css+="font-style: "+o.font_style.getVal()+"; ",this.fontStyles+="font-style: "+o.font_style.getVal()+"; "),isNumeric(o.line_height.getVal())&&(css+="line-height: "+o.line_height.getVal()+"px; ",this.fontStyles+="line-height: "+o.line_height.getVal()+"px; "),""!==o.text_color.getVal()&&(css+="color: "+o.text_color.getVal()+"; ",this.fontStyles+="color: "+o.text_color.getVal()+"; "),""!==o.text_align.getVal()&&(css+="text-align: "+o.text_align.getVal()+"; ",this.fontStyles+="text-align: "+o.text_align.getVal()+"; "),""!==o.text_decoration.getVal()&&(css+="text-decoration: "+o.text_decoration.getVal()+"; ",this.fontStyles+="text-decoration: "+o.text_decoration.getVal()+"; "),""!==o.text_transform.getVal()&&(css+="text-transform: "+o.text_transform.getVal()+"; ",this.fontStyles+="text-transform: "+o.text_transform.getVal()+"; "),""!==o.text_shadow.getVal()&&(css+="text-shadow: "+o.text_shadow.getVal()+"; ",this.fontStyles+="text-shadow: "+o.text_shadow.getVal()+"; "));var o=this.controls.style;if(o){var c_bg=hexToRgb(o.background_color.getVal());css+="background-color: rgba("+c_bg.r+", "+c_bg.g+", "+c_bg.b+", "+o.background_opacity.getVal()+"); ",isNumeric(o.opacity.getVal())&&(css+="opacity: "+o.opacity.getVal()+"; "),""!==o.box_shadow.getVal()&&(css+="box-shadow: "+o.box_shadow.getVal()+"; "),isNumeric(o.border_width.getVal())&&(css+="border-width: "+o.border_width.getVal()+"px; "),""!==o.border_style.getVal()&&(css+="border-style: "+o.border_style.getVal()+"; ");var c_bg=hexToRgb(o.border_color.getVal());css+="border-color: rgba("+c_bg.r+", "+c_bg.g+", "+c_bg.b+", "+o.border_opacity.getVal()+"); ",isNumeric(o.border_radius.getVal())&&(css+="border-radius: "+o.border_radius.getVal()+"px; ")}return css},Element.prototype.generateLayoutClass=function(){var o=this.controls.layout;if(1==parseInt(o.use_grid.getVal(),10)){var classes="",v=o.column_span.getVal();return 1==parseInt(v.xs.use,10)&&(classes+=v.xs.class+" ",0==parseInt(v.xs.visible,10)&&(classes+="hidden-xs ")),1==parseInt(v.sm.use,10)&&(classes+=v.sm.class+" ",0==parseInt(v.sm.visible,10)&&(classes+="hidden-sm ")),1==parseInt(v.md.use,10)&&(classes+=v.md.class+" ",0==parseInt(v.md.visible,10)&&(classes+="hidden-md ")),1==parseInt(v.lg.use,10)&&(classes+=v.lg.class+" ",0==parseInt(v.lg.visible,10)&&(classes+="hidden-lg ")),classes}return""},Element.prototype.render=function(){var selected=!1;$("#"+this.id).hasClass("sq-element-selected")&&(selected=!0),$("#"+this.id).attr("style",this.generateStyles()),$("#"+this.id).attr("class","sq-element "+this.generateLayoutClass()),$("#"+this.id).html(this.content()),selected&&$("#"+this.id).addClass("sq-element-selected")},Element.prototype.appendEditorControls=function(){var html="";html+='     <div class="sq-element-controls">',html+='         <div class="sq-element-control-drag"></div>',html+="     </div>",$("#"+this.id).append(html)},Element.prototype.getCurrentOptions=function(){var options={};for(var controlGroupName in this.controls)for(var controlName in this.controls[controlGroupName]){var c=this.controls[controlGroupName][controlName];options[controlGroupName]||(options[controlGroupName]={}),options[controlGroupName][controlName]=c.getVal()}return options},Element.prototype.generateHTML=function(){var html="";return html+='<div id="'+this.id+'" class="squares-element '+this.generateLayoutClass()+'" style="'+this.generateStyles()+'">',html+=this.content(),html+="</div>"},EditorWindow.prototype.init=function(){var WindowHTML="";WindowHTML+=' <div class="sq-window" id="sq-window-'+this.id+'">',WindowHTML+='     <div class="sq-window-header">',WindowHTML+='         <div class="sq-window-main-nav">',WindowHTML+='             <div id="sq-window-main-nav-button-elements" class="sq-window-main-nav-button" data-tab-group="sq-window-main-tab-group" data-tab-index="0" data-tab-button><i class="fa fa-cube" aria-hidden="true"></i></div>',WindowHTML+='             <div id="sq-window-main-nav-button-settings" class="sq-window-main-nav-button" data-tab-group="sq-window-main-tab-group" data-tab-index="1" data-tab-button><i class="fa fa-cog" aria-hidden="true"></i></div>',WindowHTML+="         </div>",WindowHTML+='         <div class="sq-window-close"><i class="fa fa-times"></i></div>',
WindowHTML+="     </div>",WindowHTML+='     <div class="sq-window-container">',WindowHTML+='         <div class="sq-window-tab-content" data-tab-group="sq-window-main-tab-group" data-tab-index="0" data-tab-content id="sq-window-elements-tab-content">',WindowHTML+='             <div class="sq-window-main-tab-header">',WindowHTML+="                 <h1>Elements</h1>",WindowHTML+='                 <div id="sq-window-elements-search">',WindowHTML+='                     <i class="fa fa-search" aria-hidden="true"></i>',WindowHTML+='                     <input type="text" id="sq-window-elements-search-input">',WindowHTML+="                 </div>",WindowHTML+="             </div>",WindowHTML+='             <div class="sq-window-content">',WindowHTML+='                 <div id="sq-no-elements-found">No elements found.</div>';for(var i=0;i<registeredElements.length;i++)WindowHTML+='             <div class="sq-element-thumb" data-index="'+i+'">',WindowHTML+='                 <div class="sq-element-thumb-icon">',WindowHTML+='                     <i class="'+registeredElements[i].iconClass+'"></i>',WindowHTML+="                 </div>",WindowHTML+='                 <div class="sq-element-thumb-title">',WindowHTML+="                     <h2>"+registeredElements[i].name+"</h2>",WindowHTML+="                 </div>",WindowHTML+="             </div>";WindowHTML+='                 <div class="squares-clear"></div>',WindowHTML+="             </div>",WindowHTML+="         </div>",WindowHTML+='         <div class="sq-window-tab-content" data-tab-group="sq-window-main-tab-group" data-tab-index="1" data-tab-content id="sq-window-settings-tab-content">',WindowHTML+='             <div class="sq-window-main-tab-header"><h1>Settings</h1></div>',WindowHTML+='             <div id="sq-window-settings-tab-inner-content"></div>',WindowHTML+="         </div>",WindowHTML+="     </div>",WindowHTML+=" </div>",0==$(".sq-windows-root").length&&$("body").prepend('<div class="sq-windows-root"></div>'),$(".sq-windows-root").html(WindowHTML),this.root=$("#sq-window-"+this.id),this.openFirstTab(),this.removeElementSettings()},EditorWindow.prototype.events=function(){var self=this;$(document).on("keyup","#sq-window-elements-search-input",function(){var v=$(this).val().toLowerCase(),elementsFound=!1;$(".sq-element-thumb").each(function(){var elementTitle=$(this).find("h2").html();elementTitle.toLowerCase().indexOf(v)>=0?(elementsFound=!0,$(this).show()):$(this).hide()}),elementsFound?$("#sq-no-elements-found").hide():$("#sq-no-elements-found").show()}),$(document).on("click",".sq-element",function(){if(!self.visible){var x=$(this).offset().left+$(this).closest(".sq-root-container").width()+40,y=$(this).offset().top;self.show(x,y)}var editor=$(this).closest(".sq-root-container").data.editor,containerIndex=$(this).closest(".sq-container").data("index"),elementIndex=$(this).data("index"),el=editor.settings.containers[containerIndex].settings.elements[elementIndex];$("#sq-window-elements-tab-content").hide(),$("#sq-window-settings-tab-content").show(),$(".sq-window-main-nav-button").removeClass("active"),$("#sq-window-main-nav-button-settings").addClass("active"),$("#sq-window-settings-tab-inner-content").html(el.getSettingsForm()),el.loadOptions(),$('[data-tab-content][data-tab-group="sq-element-settings-tab-group"]').hide(),$('[data-tab-content][data-tab-group="sq-element-settings-tab-group"][data-tab-index="0"]').show(),$('[data-tab-button][data-tab-group="sq-element-settings-tab-group"]').removeClass("active").first().addClass("active"),editor.selectElement(el.id)}),$(document).on("click",".sq-add-elements",function(){if(!self.visible){var x=$(this).closest(".sq-root-container").offset().left+$(this).closest(".sq-root-container").width()+40,y=$(this).closest(".sq-root-container").offset().top;self.show(x+20,y+20)}$("#sq-window-elements-tab-content").show(),$("#sq-window-settings-tab-content").hide(),$(".sq-window-main-nav-button").removeClass("active"),$("#sq-window-main-nav-button-elements").addClass("active")}),$(document).on("click","[data-tab-button]",function(){var index=$(this).data("tab-index"),tabGroup=$(this).data("tab-group");$('[data-tab-button][data-tab-group="'+tabGroup+'"]').removeClass("active"),$(this).addClass("active"),$('[data-tab-content][data-tab-group="'+tabGroup+'"]').hide(),$('[data-tab-content][data-tab-group="'+tabGroup+'"][data-tab-index="'+index+'"]').show()}),self.root.find(".sq-window-close").on("click",function(e){self.hide()}),self.root.find(".sq-window-header").off("mousedown"),self.root.find(".sq-window-header").on("mousedown",function(e){$(e.target).hasClass("sq-window-close")||$(e.target).closest(".sq-window-close").length>0||(self.shouldStartDragging=!0,self.iex=e.pageX,self.iey=e.pageY,$(".sq-window-active").removeClass("sq-window-active"),self.root.addClass("sq-window-active"))}),$(document).on("mousemove."+self.id,function(e){self.shouldStartDragging&&!self.didStartDragging&&(Math.abs(e.pageX-self.iex)>5||Math.abs(e.pageY-self.iey)>5)&&(self.ix=self.root.offset().left,self.iy=self.root.offset().top,self.dragging=!0,self.didStartDragging=!0),self.dragging&&self.root.css({left:self.ix+e.pageX-self.iex,top:self.iy+e.pageY-self.iey})}),$(document).on("mouseup."+self.id,function(e){self.shouldStartDragging=!1,self.didStartDragging=!1,self.dragging=!1});var shouldStartDraggingElementToContainer=!1,didStartDraggingElementToContainer=!1,draggingElementToContainer=!1,virtualIndexOfDraggedElement=-1,draggedElementFromWindowCatalogIndex=-1,thumbElWhenDraggingFromWindow=undefined,dummyElementAtMouse=undefined,elementDragMap=undefined,iex=0,iey=0,ix=0,iy=0;$(document).off("mousedown",".sq-element-thumb"),$(document).on("mousedown",".sq-element-thumb",function(e){shouldStartDraggingElementToContainer=!0,iex=e.pageX,iey=e.pageY,thumbElWhenDraggingFromWindow=$(this)}),$(document).off("mousemove.elementFromWindow"),$(document).on("mousemove.elementFromWindow",function(e){if(shouldStartDraggingElementToContainer&&!didStartDraggingElementToContainer&&(Math.abs(e.pageX-iex)>5||Math.abs(e.pageY-iey)>5)){didStartDraggingElementToContainer=!0,draggedElementFromWindowCatalogIndex=thumbElWhenDraggingFromWindow.data("index");var contents=thumbElWhenDraggingFromWindow.html();ix=thumbElWhenDraggingFromWindow.offset().left,iy=thumbElWhenDraggingFromWindow.offset().top,$("body").prepend('<div id="sq-dragged-element-clone" class="sq-element-thumb">'+contents+"</div>"),dummyElementAtMouse=$("#sq-dragged-element-clone"),dummyElementAtMouse.css({left:ix,top:iy,margin:0}),elementDragMap=new Array;for(var k=0;k<editors.length;k++)for(var editor=editors[k],i=0;i<editor.settings.containers.length;i++){var c=editor.host.find(".sq-container[data-index="+i+"]");if(0==editor.settings.containers[i].settings.elements.length){c.append('<div id="sq-dummy-element-dragging-from-window-tmp"></div>');var x=$("#sq-dummy-element-dragging-from-window-tmp").offset().left+$("#sq-dummy-element-dragging-from-window-tmp").outerWidth()/2,y=$("#sq-dummy-element-dragging-from-window-tmp").offset().top+$("#sq-dummy-element-dragging-from-window-tmp").outerHeight()/2;elementDragMap.push({x:x,y:y,elementIndex:0,containerIndex:i,editorIndex:k}),$("#sq-dummy-element-dragging-from-window-tmp").remove()}for(var j=0;j<editor.settings.containers[i].settings.elements.length;j++){var el=c.find(".sq-element[data-index="+j+"]");el.before('<div id="sq-dummy-element-dragging-from-window-tmp"></div>');var x=$("#sq-dummy-element-dragging-from-window-tmp").offset().left+$("#sq-dummy-element-dragging-from-window-tmp").outerWidth()/2,y=$("#sq-dummy-element-dragging-from-window-tmp").offset().top+$("#sq-dummy-element-dragging-from-window-tmp").outerHeight()/2;if(elementDragMap.push({x:x,y:y,elementIndex:j,containerIndex:i,editorIndex:k}),$("#sq-dummy-element-dragging-from-window-tmp").remove(),j==editor.settings.containers[i].settings.elements.length-1){el.after('<div id="sq-dummy-element-dragging-from-window-tmp"></div>');var x=$("#sq-dummy-element-dragging-from-window-tmp").offset().left+$("#sq-dummy-element-dragging-from-window-tmp").outerWidth()/2,y=$("#sq-dummy-element-dragging-from-window-tmp").offset().top+$("#sq-dummy-element-dragging-from-window-tmp").outerHeight()/2;elementDragMap.push({x:x,y:y,elementIndex:j+1,containerIndex:i,editorIndex:k}),$("#sq-dummy-element-dragging-from-window-tmp").remove()}}}0==elementDragMap.length&&(dummyElementAtMouse.remove(),didStartDraggingElementToContainer=!1,shouldStartDraggingElementToContainer=!1,didStartDraggingElementToContainer=!1,draggingElementToContainer=!1,virtualIndexOfDraggedElement=-1)}if(didStartDraggingElementToContainer){dummyElementAtMouse.css({left:ix+e.pageX-iex,top:iy+e.pageY-iey});for(var closestIndex=0,closestDistance=999999,i=0;i<elementDragMap.length;i++){var d=Math.abs(e.pageX-elementDragMap[i].x)+Math.abs(e.pageY-elementDragMap[i].y);d<closestDistance&&(closestDistance=d,closestIndex=i)}if(closestIndex!=virtualIndexOfDraggedElement){virtualIndexOfDraggedElement=closestIndex,$("#sq-dummy-element-dragging-from-window").remove();var containerIndex=elementDragMap[virtualIndexOfDraggedElement].containerIndex,elementIndex=elementDragMap[virtualIndexOfDraggedElement].elementIndex,editorIndex=elementDragMap[virtualIndexOfDraggedElement].editorIndex,c=editors[editorIndex].host.find(".sq-container[data-index="+containerIndex+"]");if(0==editors[editorIndex].settings.containers[containerIndex].settings.elements.length)c.prepend('<div id="sq-dummy-element-dragging-from-window"><div id="sq-dummy-element-dragging-from-window-inner"></div></div>');else if(elementIndex==editors[editorIndex].settings.containers[containerIndex].settings.elements.length){var lastElementIndex=editors[editorIndex].settings.containers[containerIndex].settings.elements.length-1,e=c.find(".sq-element[data-index="+lastElementIndex+"]");e.after('<div id="sq-dummy-element-dragging-from-window"><div id="sq-dummy-element-dragging-from-window-inner"></div></div>')}else{var e=c.find(".sq-element[data-index="+elementIndex+"]");e.before('<div id="sq-dummy-element-dragging-from-window"><div id="sq-dummy-element-dragging-from-window-inner"></div></div>')}}}}),$(document).off("mouseup.elementFromWindow"),$(document).on("mouseup.elementFromWindow",function(){if(didStartDraggingElementToContainer){dummyElementAtMouse.remove();var containerIndex=elementDragMap[virtualIndexOfDraggedElement].containerIndex,elementIndex=elementDragMap[virtualIndexOfDraggedElement].elementIndex,editorIndex=elementDragMap[virtualIndexOfDraggedElement].editorIndex;editors[editorIndex].addElement(containerIndex,elementIndex,draggedElementFromWindowCatalogIndex)}shouldStartDraggingElementToContainer=!1,didStartDraggingElementToContainer=!1,draggingElementToContainer=!1,virtualIndexOfDraggedElement=-1})},EditorWindow.prototype.show=function(x,y){this.visible=!0,this.root.show(),x!==undefined&&y!==undefined&&this.root.css({left:x,top:y})},EditorWindow.prototype.hide=function(){this.visible=!1,this.root.hide()},EditorWindow.prototype.openFirstTab=function(){$(".sq-window-main-nav-button").removeClass("active"),$("#sq-window-main-nav-button-elements").addClass("active"),$('[data-tab-content][data-tab-group="sq-window-main-tab-group"]').hide(),$('[data-tab-content][data-tab-group="sq-window-main-tab-group"][data-tab-index="0"]').show()},EditorWindow.prototype.removeElementSettings=function(){$("#sq-window-settings-tab-inner-content").html('<div id="sq-window-settings-tab-no-element">No element selected. To create an element, open the Elements tab and drag an element into a container.</div>')},SquaresControl.prototype.getVal=function(){return this._value},SquaresControl.prototype.setVal=function(v){this._value=v;try{this.setValue(v)}catch(err){}},SquaresControl.prototype.loadVal=function(v){this.setValue(this._value)},SquaresControl.prototype.valueChanged=function(){this._value=this.getValue(),this.valueUpdated()}}(jQuery,window,document);